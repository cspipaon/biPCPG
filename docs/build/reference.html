<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reference &mdash; biPCPG 0.1.0 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> biPCPG
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pcpg-class">PCPG class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-correlations">Correlations Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-bootstrap">Bootstrap functions</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">biPCPG</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/reference.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="reference">
<h1>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pcpg-class">
<h2>PCPG class<a class="headerlink" href="#pcpg-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pcpg.PCPG">
<em class="property">class </em><code class="sig-prename descclassname">pcpg.</code><code class="sig-name descname">PCPG</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">corr_matrix</span></em>, <em class="sig-param"><span class="n">variable_names</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pcpg.PCPG" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to obtain a Partial Correlation Planar Graph (PCPG) network from a correlation matrix. [1]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_matrix</strong> (<em>pandas.DataFrame/numpy.ndarray</em>) – Correlation matrix displaying correlations
among variables in the system.</p></li>
<li><p><strong>variable_names</strong> (<em>list</em>) – Names of the variables in the system. The order of this list should coincide with
the order of rows and columns in <code class="docutils literal notranslate"><span class="pre">corr_matrix</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>This class includes methods to perform the necessary computations and obtain a <code class="docutils literal notranslate"><span class="pre">networkx.Graph</span></code> network
object. The PCPG algorithm consists in the following steps:</p>
<p>1. find the <em>Average influence</em> (AI) between every <em>ordered</em> pair of variables in the system (in this
case those in the correlation matrix),
2. list the AIs in order from largest to smallest,
3. iterate through the list and add a <em>directed</em> edge corresponding to the pair of variables of the
AI value in that position <strong>if and only if</strong> (i) the reversed edge is not already in the network and (ii)
the network’s planarity is not broken by adding the edge.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>avg_influence_matrix</strong> – Matrix containing average influence values between pairs of variables.</p></li>
<li><p><strong>avg_influence_df</strong> – <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> containing average influence values between pairs of variables.</p></li>
<li><p><strong>influence_df</strong> – <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> containing influence values between pairs of variables.</p></li>
<li><p><strong>partial_corr_df</strong> – Multi-index <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> partial correlation values between triple of
variables.</p></li>
<li><p><strong>network</strong> – the PCPG network generated (a <code class="docutils literal notranslate"><span class="pre">networkx.DiGraph</span></code> directed graph object).</p></li>
<li><p><strong>nodes</strong> – Nodes in PCPG <code class="xref py py-attr docutils literal notranslate"><span class="pre">network</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>corr_matrix</strong> (<em>pandas.core.frame.DataFrame</em>) – </p></li>
<li><p><strong>variable_names</strong> (<em>Optional</em><em>[</em><em>List</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="py method">
<dt id="pcpg.PCPG.add_edge_attribute">
<code class="sig-name descname">add_edge_attribute</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">attr_data</span></em>, <em class="sig-param"><span class="n">attr_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pcpg.PCPG.add_edge_attribute" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds data for single attribute to edges in <code class="xref py py-attr docutils literal notranslate"><span class="pre">network</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attr_data</strong> (<em>dict/pandas.DataFrame</em>) – pd.DataFrame or dictionary containing edge attribute values.</p></li>
<li><p><strong>attr_name</strong> (<em>str</em>) – Name of attribute to be added to edges.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pcpg.PCPG.add_node_attribute">
<code class="sig-name descname">add_node_attribute</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">attr_data</span></em>, <em class="sig-param"><span class="n">attr_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pcpg.PCPG.add_node_attribute" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds node attribute data to nodes in <code class="xref py py-attr docutils literal notranslate"><span class="pre">network</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attr_data</strong> (<em>dict/pandas.DataFrame</em>) – <code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code> or dictionary containing node attribute values.</p></li>
<li><p><strong>attr_name</strong> (<em>str</em>) – Name of attribute added.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pcpg.PCPG.compute_assortativity">
<code class="sig-name descname">compute_assortativity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node_attribute</span></em>, <em class="sig-param"><span class="n">attr_type</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pcpg.PCPG.compute_assortativity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute node assortativity based on <code class="docutils literal notranslate"><span class="pre">node_attribute</span></code> of nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node_attribute</strong> (<em>str</em>) – Name of node attribute in <code class="xref py py-attr docutils literal notranslate"><span class="pre">network</span></code> by which to compute assortativity.</p></li>
<li><p><strong>attr_type</strong> (<em>str</em>) – Either “qual” or “quant”. Indicates if <code class="docutils literal notranslate"><span class="pre">node_attribute</span></code> data is a qualitative
characteristic or a quantitative characteristic.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of calculated assortativity.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pcpg.PCPG.compute_avg_influence_matrix">
<code class="sig-name descname">compute_avg_influence_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcpg.PCPG.compute_avg_influence_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute average influences between every pair of variables in the system and put these in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">avg_influence_matrix</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pcpg.PCPG.compute_influence_avg_influence_partial_corr_dfs">
<code class="sig-name descname">compute_influence_avg_influence_partial_corr_dfs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcpg.PCPG.compute_influence_avg_influence_partial_corr_dfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute partial correlations, influences and average influences between all variables in the system and put
these in <code class="xref py py-attr docutils literal notranslate"><span class="pre">partial_corr_df</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">influence_df</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">avg_influence_df</span></code> respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pcpg.PCPG.create_network">
<code class="sig-name descname">create_network</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcpg.PCPG.create_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Create PCPG a <code class="docutils literal notranslate"><span class="pre">networkx.DiGraph</span></code> object with <code class="xref py py-attr docutils literal notranslate"><span class="pre">nodes</span></code>: and edges found following the PCPG algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pcpg.PCPG.find_edges">
<code class="sig-name descname">find_edges</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pcpg.PCPG.find_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the edges in the PCPG network using the average influences in <code class="xref py py-attr docutils literal notranslate"><span class="pre">avg_influence_matrix</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of edges in the PCPG network</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-correlations">
<span id="correlations-functions"></span><h2>Correlations Functions<a class="headerlink" href="#module-correlations" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="correlations.compute_corr_matrix">
<code class="sig-prename descclassname">correlations.</code><code class="sig-name descname">compute_corr_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">matrix</span></em>, <em class="sig-param"><span class="n">critical_value</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#correlations.compute_corr_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain a correlation matrix among the variables in a matrix. If <code class="docutils literal notranslate"><span class="pre">critical</span> <span class="pre">value</span></code> is passed, the correlation matrix
is filtered based on a statistical significance T-test where <code class="docutils literal notranslate"><span class="pre">critical_value</span></code> is the threshold value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> (<em>numpy.ndarray</em>) – <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> containing time series for the values of interest with
observations along axis 0 (rows) and variables along axis 1 (columns).</p></li>
<li><p><strong>critical_value</strong> (<em>float</em>) – Boundary of the acceptance region of the T-test performed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Correlation matrix displaying correlation coefficients between the columns (axis 1) of each input matrix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="correlations.corr_pvalue_matrices">
<code class="sig-prename descclassname">correlations.</code><code class="sig-name descname">corr_pvalue_matrices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">matrix</span></em><span class="sig-paren">)</span><a class="headerlink" href="#correlations.corr_pvalue_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain a correlation matrix and p-value matrix for a matrix containing variables and observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>matrix</strong> (<em>numpy.ndarray</em>) – 2-dimensional numpy.ndarray containing containing observations axis 0 and
variables along axis 1.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple containing correlation matrix showing correlation coefficients between columns of input matrix
and p-value matrix showing statistical significance of correlations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="correlations.get_correlation_matrices_for_list_of_matrices">
<code class="sig-prename descclassname">correlations.</code><code class="sig-name descname">get_correlation_matrices_for_list_of_matrices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list_matrices</span></em>, <em class="sig-param"><span class="n">critical_value</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#correlations.get_correlation_matrices_for_list_of_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain a correlation matrix and p-value matrix for each matrix (containing variables along the columns and
observations along the rows) in <code class="docutils literal notranslate"><span class="pre">list_matrices</span></code>. If <code class="docutils literal notranslate"><span class="pre">critical</span> <span class="pre">value</span></code> is passed, each correlation matrix is
filtered based on a statistical significance T-test where <code class="docutils literal notranslate"><span class="pre">critical_value</span></code> is the threshold value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>list_matrices</strong> (<em>list</em>) – list of 2-dimensional <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> s containing observations along axis 0 (rows)
and variables along axis 1 (columns).</p></li>
<li><p><strong>critical_value</strong> (<em>float</em>) – Boundary of the acceptance region of the T-test performed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple containing: (i) list of length len(list_time_series_matrices) containing correlation matrices
displaying the correlation coefficients between the columns (axis 1) of each input matrix, and (ii) list of
p-value matrices corresponding to each correlation matrix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-bootstrap">
<span id="bootstrap-functions"></span><h2>Bootstrap functions<a class="headerlink" href="#module-bootstrap" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="bootstrap.construct_corr_matrix_replicates_from_time_series_matrices">
<code class="sig-prename descclassname">bootstrap.</code><code class="sig-name descname">construct_corr_matrix_replicates_from_time_series_matrices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">array_of_matrices</span></em>, <em class="sig-param"><span class="n">num_replicates</span></em>, <em class="sig-param"><span class="n">critical_value</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#bootstrap.construct_corr_matrix_replicates_from_time_series_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a bootstrap procedure on time series matrices to obtain correlation matrix replicates. If
<code class="docutils literal notranslate"><span class="pre">critical_value</span></code> is not None, the correlation matrices are filtered using a statistical significance T-test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array_of_matrices</strong> (<em>numpy.ndarray</em>) – 3-dimensional <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> with axis 0 representing elements of one of
the sets in the bipartite system, axis 1 representing time series observations and axis 2 representing elements
of the remaining set in the bipartite system.</p></li>
<li><p><strong>num_replicates</strong> (<em>int</em>) – Number of correlation matrix replicates to be constructed</p></li>
<li><p><strong>critical_value</strong> (<em>float</em>) – If passed, boundary of the acceptance region of the T-test performed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array containing mean of correlation matrix replicates in each batch.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="bootstrap.get_boostrap_values">
<code class="sig-prename descclassname">bootstrap.</code><code class="sig-name descname">get_boostrap_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">timeseries_matrices</span></em>, <em class="sig-param"><span class="n">num_replicates</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">critical_value</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#bootstrap.get_boostrap_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute bootstrap values for edges in a PCPG network. This function takes a dataset in the form of a list or
numpy array of matrices with time series in its columns (see <a class="reference internal" href="tutorial.html#dataset-info"><span class="std std-ref">Dataset structure</span></a>) performs a bootstrap procedure
that generates a total of <code class="docutils literal notranslate"><span class="pre">num_replicates</span></code> replicate PCPG matrices and finds the bootstrap value of each edge,
i.e. the fraction of times the edge appears in these networks. If <code class="docutils literal notranslate"><span class="pre">critical_value</span></code> is not None, the replicate
correlation matrices generated are filtered using a statistical significance T-test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timeseries_matrices</strong> (<em>list/numpy.ndarray</em>) – Iterable containing the dataset for which the PCPG network was
generated. This should be a list containing matrices whose columns contain observations for one of the the two
sets of variables in a bipartite dataset.</p></li>
<li><p><strong>num_replicates</strong> (<em>int</em>) – Number of replicates to generate in the bootstrap procedure.</p></li>
<li><p><strong>critical_value</strong> (<em>float</em>) – If passed, boundary of the acceptance region of the T-test performed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pandas.DataFrame containing the bootstrap values of the <em>directed</em> edges in the PCPG network. Note that
the source of an edge is its row index and the target of the edge is its column index.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial.html" class="btn btn-neutral float-left" title="Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Carlos Saenz de Pipaon.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>